module.exports=[96559,a=>{"use strict";let b=(0,a.i(48137).default)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);a.s(["Search",()=>b],96559)},13586,a=>{"use strict";var b=a.i(42e3),c=a.i(57491);function d({className:a,type:d,...e}){return(0,b.jsx)("input",{type:d,"data-slot":"input",className:(0,c.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",a),...e})}a.s(["Input",()=>d])},67669,a=>{"use strict";let b=(0,a.i(48137).default)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);a.s(["RefreshCw",()=>b],67669)},55052,a=>{"use strict";let b=(0,a.i(48137).default)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);a.s(["Clock",()=>b],55052)},17455,97202,97758,a=>{"use strict";var b=a.i(48137);let c=(0,b.default)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);a.s(["CheckCircle",()=>c],17455);let d=(0,b.default)("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);a.s(["Building2",()=>d],97202);let e=(0,b.default)("Warehouse",[["path",{d:"M22 8.35V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8.35A2 2 0 0 1 3.26 6.5l8-3.2a2 2 0 0 1 1.48 0l8 3.2A2 2 0 0 1 22 8.35Z",key:"gksnxg"}],["path",{d:"M6 18h12",key:"9pbo8z"}],["path",{d:"M6 14h12",key:"4cwo0f"}],["rect",{width:"12",height:"12",x:"6",y:"10",key:"apd30q"}]]);a.s(["Warehouse",()=>e],97758)},71310,a=>{"use strict";var b=a.i(42e3),c=a.i(41771),d=a.i(67669),e=a.i(55052),f=a.i(94752),g=a.i(96559),h=a.i(26982),i=a.i(17455),j=a.i(97202),k=a.i(97758),l=a.i(75773),m=a.i(13586),n=a.i(83397),o=a.i(99826),p=a.i(972),q=a.i(67815),r=a.i(33332);let s={returned_to_supplier:"تم الإرجاع للمورد",kept_in_warehouse:"محفوظ في المخزن",replaced_from_supplier:"تم الاستبدال من المورد"};function t(){let[a,t]=(0,c.useState)([]),[u,v]=(0,c.useState)(!0),[w,x]=(0,c.useState)(""),[y,z]=(0,c.useState)("all"),[A,B]=(0,c.useState)(null);(0,c.useEffect)(()=>{C()},[]);let C=async()=>{let a=(0,p.createClient)(),{data:b}=await a.from("orders").select("*").eq("status","مستبدل").order("returned_at",{ascending:!1});t(b||[]),v(!1)},D=async(a,b)=>{B(a);let c=(0,p.createClient)(),{error:d}=await c.from("orders").update({return_handled:!0,return_handled_type:b,return_handled_at:new Date().toISOString(),updated_at:new Date().toISOString()}).eq("id",a);d?q.toast.error("حدث خطأ في تحديث الحالة"):(q.toast.success("تم تحديث حالة الاستبدال"),C()),B(null)},E=async a=>{B(a);let b=(0,p.createClient)(),{error:c}=await b.from("orders").update({return_handled:!1,return_handled_type:null,return_handled_at:null,updated_at:new Date().toISOString()}).eq("id",a);c?q.toast.error("حدث خطأ في تحديث الحالة"):(q.toast.success("تم إلغاء المعالجة"),C()),B(null)},F=a.filter(a=>{let b=!w.trim()||a.order_number.toString().includes(w)||a.customer_name?.toLowerCase().includes(w.toLowerCase()),c="all"===y||"handled"===y&&a.return_handled||"pending"===y&&!a.return_handled;return b&&c}),G=a.filter(a=>!a.return_handled).length,H=a.filter(a=>a.return_handled).length;return u?(0,b.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,b.jsx)("div",{className:"text-text-muted",children:"جاري التحميل..."})}):(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("h1",{className:"text-3xl font-bold text-text flex items-center gap-3",children:[(0,b.jsx)(d.RefreshCw,{className:"text-purple-500"}),"المستبدلات"]}),(0,b.jsx)("p",{className:"text-text-muted mt-1",children:"الطلبات التي تم استبدالها بمنتجات أخرى"})]}),(0,b.jsxs)("div",{className:"flex gap-3",children:[(0,b.jsxs)("div",{className:"bg-yellow-100 text-yellow-800 px-4 py-2 rounded-xl font-bold",children:["قيد الانتظار: ",G]}),(0,b.jsxs)("div",{className:"bg-green-100 text-green-800 px-4 py-2 rounded-xl font-bold",children:["تمت المعالجة: ",H]})]})]}),(0,b.jsx)("div",{className:"bg-surface rounded-2xl shadow-sm border border-border p-4",children:(0,b.jsxs)("div",{className:"flex flex-col lg:flex-row gap-4",children:[(0,b.jsxs)("div",{className:"relative flex-1 max-w-lg",children:[(0,b.jsx)(g.Search,{className:"absolute right-3 top-1/2 -translate-y-1/2 text-text-muted",size:18}),(0,b.jsx)(m.Input,{placeholder:"ابحث برقم الطلب أو اسم العميل...",value:w,onChange:a=>x(a.target.value),className:"pr-10 pl-10 rounded-xl"}),w&&(0,b.jsx)("button",{onClick:()=>x(""),className:"absolute left-3 top-1/2 -translate-y-1/2 text-text-muted hover:text-text",children:(0,b.jsx)(h.X,{size:18})})]}),(0,b.jsxs)(o.Select,{value:y,onValueChange:z,children:[(0,b.jsx)(o.SelectTrigger,{className:"w-48 rounded-xl",children:(0,b.jsx)(o.SelectValue,{placeholder:"تصفية حسب الحالة"})}),(0,b.jsxs)(o.SelectContent,{children:[(0,b.jsx)(o.SelectItem,{value:"all",children:"الكل"}),(0,b.jsx)(o.SelectItem,{value:"pending",children:"قيد الانتظار"}),(0,b.jsx)(o.SelectItem,{value:"handled",children:"تمت المعالجة"})]})]})]})}),(0,b.jsx)("div",{className:"bg-surface rounded-2xl shadow-sm border border-border",children:0===F.length?(0,b.jsxs)("div",{className:"p-12 text-center",children:[(0,b.jsx)(d.RefreshCw,{className:"mx-auto text-text-muted mb-4",size:48}),(0,b.jsx)("p",{className:"text-text-muted text-lg",children:"لا توجد مستبدلات"})]}):(0,b.jsx)("div",{className:"divide-y divide-border",children:F.map(a=>{let c=A===a.id;return(0,b.jsx)("div",{className:"p-4 hover:bg-muted/50 transition-colors",children:(0,b.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,b.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-2 flex-wrap",children:[(0,b.jsxs)("h3",{className:"text-xl font-bold text-text",children:["طلب #",a.order_number]}),(0,b.jsx)("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${(0,r.getOrderStatusColor)(a.status)}`,children:a.status}),a.return_handled?(0,b.jsxs)("span",{className:"px-3 py-1 rounded-full text-sm font-medium bg-green-100 text-green-800 flex items-center gap-1",children:[(0,b.jsx)(i.CheckCircle,{size:14}),s[a.return_handled_type||""]||"تمت المعالجة"]}):(0,b.jsx)("span",{className:"px-3 py-1 rounded-full text-sm font-medium bg-yellow-100 text-yellow-800",children:"قيد الانتظار"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-4 text-sm flex-wrap",children:[(0,b.jsxs)("p",{className:"text-text-muted flex items-center gap-1",children:[(0,b.jsx)(e.Clock,{size:16}),"تاريخ الطلب: ",(0,r.formatDate)(a.created_at)]}),a.returned_at&&(0,b.jsxs)("p",{className:"text-purple-600 flex items-center gap-1",children:[(0,b.jsx)(d.RefreshCw,{size:16}),"تاريخ الاستبدال: ",(0,r.formatDate)(a.returned_at)]}),a.customer_name&&(0,b.jsxs)("p",{className:"text-text-muted flex items-center gap-1",children:[(0,b.jsx)(f.User,{size:16}),a.customer_name]})]}),a.return_reason&&(0,b.jsxs)("p",{className:"text-sm text-purple-600 mt-2 bg-purple-50 p-2 rounded-lg",children:["سبب الاستبدال: ",a.return_reason]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-6",children:[(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("p",{className:"text-sm text-text-muted",children:"قيمة الطلب"}),(0,b.jsx)("p",{className:"text-lg font-bold text-text",children:(0,r.formatCurrency)(a.total_amount)})]}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("p",{className:"text-sm text-text-muted",children:"التكلفة"}),(0,b.jsx)("p",{className:"text-lg font-bold text-text-muted",children:(0,r.formatCurrency)(a.total_cost)})]}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("p",{className:"text-sm text-text-muted",children:"الربح"}),(0,b.jsx)("p",{className:"text-lg font-bold text-success",children:(0,r.formatCurrency)(a.total_profit)})]})]})]}),(0,b.jsx)("div",{className:"flex items-center gap-2 flex-wrap border-t border-border pt-4",children:a.return_handled?(0,b.jsxs)(n.Button,{size:"sm",variant:"outline",className:"gap-2",onClick:()=>E(a.id),disabled:c,children:[(0,b.jsx)(h.X,{size:16}),"إلغاء المعالجة"]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("span",{className:"text-sm text-text-muted ml-2",children:"تحديد كـ:"}),(0,b.jsxs)(n.Button,{size:"sm",variant:"outline",className:"gap-2 text-purple-600 border-purple-300 hover:bg-purple-50",onClick:()=>D(a.id,"replaced_from_supplier"),disabled:c,children:[(0,b.jsx)(l.Package,{size:16}),"تم الاستبدال من المورد"]}),(0,b.jsxs)(n.Button,{size:"sm",variant:"outline",className:"gap-2 text-blue-600 border-blue-300 hover:bg-blue-50",onClick:()=>D(a.id,"returned_to_supplier"),disabled:c,children:[(0,b.jsx)(j.Building2,{size:16}),"تم الإرجاع للمورد"]}),(0,b.jsxs)(n.Button,{size:"sm",variant:"outline",className:"gap-2 text-amber-600 border-amber-300 hover:bg-amber-50",onClick:()=>D(a.id,"kept_in_warehouse"),disabled:c,children:[(0,b.jsx)(k.Warehouse,{size:16}),"محفوظ في المخزن"]})]})})]})},a.id)})})}),F.length>0&&(0,b.jsxs)("div",{className:"bg-purple-50 border border-purple-200 rounded-2xl p-6",children:[(0,b.jsx)("h3",{className:"font-bold text-purple-800 mb-4",children:"ملخص المستبدلات"}),(0,b.jsxs)("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("p",{className:"text-sm text-purple-600",children:"عدد المستبدلات"}),(0,b.jsx)("p",{className:"text-2xl font-bold text-purple-800",children:F.length})]}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("p",{className:"text-sm text-purple-600",children:"إجمالي قيمة المستبدلات"}),(0,b.jsx)("p",{className:"text-2xl font-bold text-purple-800",children:(0,r.formatCurrency)(F.reduce((a,b)=>a+b.total_amount,0))})]}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("p",{className:"text-sm text-purple-600",children:"إجمالي التكلفة"}),(0,b.jsx)("p",{className:"text-2xl font-bold text-purple-800",children:(0,r.formatCurrency)(F.reduce((a,b)=>a+b.total_cost,0))})]}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("p",{className:"text-sm text-purple-600",children:"ملاحظة"}),(0,b.jsx)("p",{className:"text-sm text-purple-700",children:"المستبدلات تحافظ على الأرباح عند الاستبدال"})]})]})]})]})}a.s(["default",()=>t])}];

//# sourceMappingURL=Downloads_arabic-store-management%20%281%29_fe9c693b._.js.map