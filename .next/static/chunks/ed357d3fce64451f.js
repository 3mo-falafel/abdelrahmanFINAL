(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,40984,e=>{"use strict";let t=(0,e.i(16101).default)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);e.s(["Search",()=>t],40984)},78749,e=>{"use strict";var t=e.i(34017),s=e.i(16307);function r({className:e,type:r,...a}){return(0,t.jsx)("input",{type:r,"data-slot":"input",className:(0,s.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",e),...a})}e.s(["Input",()=>r])},75280,e=>{"use strict";let t=(0,e.i(16101).default)("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);e.s(["RotateCcw",()=>t],75280)},52542,e=>{"use strict";let t=(0,e.i(16101).default)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);e.s(["Clock",()=>t],52542)},57462,11117,31107,e=>{"use strict";var t=e.i(16101);let s=(0,t.default)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);e.s(["CheckCircle",()=>s],57462);let r=(0,t.default)("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);e.s(["Building2",()=>r],11117);let a=(0,t.default)("Warehouse",[["path",{d:"M22 8.35V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8.35A2 2 0 0 1 3.26 6.5l8-3.2a2 2 0 0 1 1.48 0l8 3.2A2 2 0 0 1 22 8.35Z",key:"gksnxg"}],["path",{d:"M6 18h12",key:"9pbo8z"}],["path",{d:"M6 14h12",key:"4cwo0f"}],["rect",{width:"12",height:"12",x:"6",y:"10",key:"apd30q"}]]);e.s(["Warehouse",()=>a],31107)},10683,e=>{"use strict";var t=e.i(34017),s=e.i(1894),r=e.i(75280),a=e.i(52542),l=e.i(13731),d=e.i(40984),n=e.i(55013),i=e.i(57462),c=e.i(11117),x=e.i(31107),o=e.i(78681),u=e.i(78749),m=e.i(87837),h=e.i(6757),p=e.i(7356),g=e.i(50410),f=e.i(29684);let j={returned_to_supplier:"تم الإرجاع للمورد",kept_in_warehouse:"محفوظ في المخزن",replaced_from_supplier:"تم الاستبدال من المورد"},b={returned_to_supplier:c.Building2,kept_in_warehouse:x.Warehouse,replaced_from_supplier:o.Package};function N(){let[e,o]=(0,s.useState)([]),[N,v]=(0,s.useState)(!0),[y,_]=(0,s.useState)(""),[w,k]=(0,s.useState)("all"),[C,S]=(0,s.useState)(null);(0,s.useEffect)(()=>{z()},[]);let z=async()=>{let e=(0,p.createClient)(),{data:t}=await e.from("orders").select("*").eq("status","مرتجع").order("returned_at",{ascending:!1});o(t||[]),v(!1)},M=async(e,t)=>{S(e);let s=(0,p.createClient)(),{error:r}=await s.from("orders").update({return_handled:!0,return_handled_type:t,return_handled_at:new Date().toISOString(),updated_at:new Date().toISOString()}).eq("id",e);r?g.toast.error("حدث خطأ في تحديث الحالة"):(g.toast.success("تم تحديث حالة المرتجع"),z()),S(null)},B=async e=>{S(e);let t=(0,p.createClient)(),{error:s}=await t.from("orders").update({return_handled:!1,return_handled_type:null,return_handled_at:null,updated_at:new Date().toISOString()}).eq("id",e);s?g.toast.error("حدث خطأ في تحديث الحالة"):(g.toast.success("تم إلغاء المعالجة"),z()),S(null)},q=e.filter(e=>{let t=!y.trim()||e.order_number.toString().includes(y)||e.customer_name?.toLowerCase().includes(y.toLowerCase()),s="all"===w||"handled"===w&&e.return_handled||"pending"===w&&!e.return_handled;return t&&s}),I=e.filter(e=>!e.return_handled).length,R=e.filter(e=>e.return_handled).length;return N?(0,t.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,t.jsx)("div",{className:"text-text-muted",children:"جاري التحميل..."})}):(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("h1",{className:"text-3xl font-bold text-text flex items-center gap-3",children:[(0,t.jsx)(r.RotateCcw,{className:"text-orange-500"}),"المرتجعات"]}),(0,t.jsx)("p",{className:"text-text-muted mt-1",children:"الطلبات التي تم إرجاعها واسترداد أموالها"})]}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsxs)("div",{className:"bg-yellow-100 text-yellow-800 px-4 py-2 rounded-xl font-bold",children:["قيد الانتظار: ",I]}),(0,t.jsxs)("div",{className:"bg-green-100 text-green-800 px-4 py-2 rounded-xl font-bold",children:["تمت المعالجة: ",R]})]})]}),(0,t.jsx)("div",{className:"bg-surface rounded-2xl shadow-sm border border-border p-4",children:(0,t.jsxs)("div",{className:"flex flex-col lg:flex-row gap-4",children:[(0,t.jsxs)("div",{className:"relative flex-1 max-w-lg",children:[(0,t.jsx)(d.Search,{className:"absolute right-3 top-1/2 -translate-y-1/2 text-text-muted",size:18}),(0,t.jsx)(u.Input,{placeholder:"ابحث برقم الطلب أو اسم العميل...",value:y,onChange:e=>_(e.target.value),className:"pr-10 pl-10 rounded-xl"}),y&&(0,t.jsx)("button",{onClick:()=>_(""),className:"absolute left-3 top-1/2 -translate-y-1/2 text-text-muted hover:text-text",children:(0,t.jsx)(n.X,{size:18})})]}),(0,t.jsxs)(h.Select,{value:w,onValueChange:k,children:[(0,t.jsx)(h.SelectTrigger,{className:"w-48 rounded-xl",children:(0,t.jsx)(h.SelectValue,{placeholder:"تصفية حسب الحالة"})}),(0,t.jsxs)(h.SelectContent,{children:[(0,t.jsx)(h.SelectItem,{value:"all",children:"الكل"}),(0,t.jsx)(h.SelectItem,{value:"pending",children:"قيد الانتظار"}),(0,t.jsx)(h.SelectItem,{value:"handled",children:"تمت المعالجة"})]})]})]})}),(0,t.jsx)("div",{className:"bg-surface rounded-2xl shadow-sm border border-border",children:0===q.length?(0,t.jsxs)("div",{className:"p-12 text-center",children:[(0,t.jsx)(r.RotateCcw,{className:"mx-auto text-text-muted mb-4",size:48}),(0,t.jsx)("p",{className:"text-text-muted text-lg",children:"لا توجد مرتجعات"})]}):(0,t.jsx)("div",{className:"divide-y divide-border",children:q.map(e=>{let s=C===e.id;return e.return_handled_type&&b[e.return_handled_type],(0,t.jsx)("div",{className:"p-4 hover:bg-muted/50 transition-colors",children:(0,t.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,t.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-2 flex-wrap",children:[(0,t.jsxs)("h3",{className:"text-xl font-bold text-text",children:["طلب #",e.order_number]}),(0,t.jsx)("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${(0,f.getOrderStatusColor)(e.status)}`,children:e.status}),e.return_handled?(0,t.jsxs)("span",{className:"px-3 py-1 rounded-full text-sm font-medium bg-green-100 text-green-800 flex items-center gap-1",children:[(0,t.jsx)(i.CheckCircle,{size:14}),j[e.return_handled_type||""]||"تمت المعالجة"]}):(0,t.jsx)("span",{className:"px-3 py-1 rounded-full text-sm font-medium bg-yellow-100 text-yellow-800",children:"قيد الانتظار"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-4 text-sm flex-wrap",children:[(0,t.jsxs)("p",{className:"text-text-muted flex items-center gap-1",children:[(0,t.jsx)(a.Clock,{size:16}),"تاريخ الطلب: ",(0,f.formatDate)(e.created_at)]}),e.returned_at&&(0,t.jsxs)("p",{className:"text-orange-600 flex items-center gap-1",children:[(0,t.jsx)(r.RotateCcw,{size:16}),"تاريخ الإرجاع: ",(0,f.formatDate)(e.returned_at)]}),e.customer_name&&(0,t.jsxs)("p",{className:"text-text-muted flex items-center gap-1",children:[(0,t.jsx)(l.User,{size:16}),e.customer_name]})]}),e.return_reason&&(0,t.jsxs)("p",{className:"text-sm text-orange-600 mt-2 bg-orange-50 p-2 rounded-lg",children:["سبب الإرجاع: ",e.return_reason]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-6",children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("p",{className:"text-sm text-text-muted",children:"قيمة الطلب"}),(0,t.jsx)("p",{className:"text-lg font-bold text-text",children:(0,f.formatCurrency)(e.total_amount)})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("p",{className:"text-sm text-text-muted",children:"المبلغ المسترد"}),(0,t.jsx)("p",{className:"text-lg font-bold text-orange-600",children:(0,f.formatCurrency)(e.refund_amount||e.paid_amount)})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("p",{className:"text-sm text-text-muted",children:"خسارة الربح"}),(0,t.jsx)("p",{className:"text-lg font-bold text-red-600",children:(0,f.formatCurrency)(e.total_profit)})]})]})]}),(0,t.jsx)("div",{className:"flex items-center gap-2 flex-wrap border-t border-border pt-4",children:e.return_handled?(0,t.jsxs)(m.Button,{size:"sm",variant:"outline",className:"gap-2",onClick:()=>B(e.id),disabled:s,children:[(0,t.jsx)(n.X,{size:16}),"إلغاء المعالجة"]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:"text-sm text-text-muted ml-2",children:"تحديد كـ:"}),(0,t.jsxs)(m.Button,{size:"sm",variant:"outline",className:"gap-2 text-blue-600 border-blue-300 hover:bg-blue-50",onClick:()=>M(e.id,"returned_to_supplier"),disabled:s,children:[(0,t.jsx)(c.Building2,{size:16}),"تم الإرجاع للمورد"]}),(0,t.jsxs)(m.Button,{size:"sm",variant:"outline",className:"gap-2 text-amber-600 border-amber-300 hover:bg-amber-50",onClick:()=>M(e.id,"kept_in_warehouse"),disabled:s,children:[(0,t.jsx)(x.Warehouse,{size:16}),"محفوظ في المخزن"]})]})})]})},e.id)})})}),q.length>0&&(0,t.jsxs)("div",{className:"bg-orange-50 border border-orange-200 rounded-2xl p-6",children:[(0,t.jsx)("h3",{className:"font-bold text-orange-800 mb-4",children:"ملخص المرتجعات"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 lg:grid-cols-5 gap-4",children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("p",{className:"text-sm text-orange-600",children:"عدد المرتجعات"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-orange-800",children:q.length})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("p",{className:"text-sm text-orange-600",children:"إجمالي قيمة المرتجعات"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-orange-800",children:(0,f.formatCurrency)(q.reduce((e,t)=>e+t.total_amount,0))})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("p",{className:"text-sm text-orange-600",children:"إجمالي المبالغ المستردة"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-orange-800",children:(0,f.formatCurrency)(q.reduce((e,t)=>e+(t.refund_amount||t.paid_amount),0))})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("p",{className:"text-sm text-orange-600",children:"الخسارة في الأرباح"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-red-600",children:(0,f.formatCurrency)(q.reduce((e,t)=>e+t.total_profit,0))})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("p",{className:"text-sm text-orange-600",children:"التكلفة المستردة"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-green-600",children:(0,f.formatCurrency)(q.reduce((e,t)=>e+t.total_cost,0))})]})]})]})]})}e.s(["default",()=>N])}]);